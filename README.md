# Задание 1 — найди ошибки

В этом репозитории находятся материалы тестового задания "Найди ошибки" для [14-й Школы разработки интерфейсов](https://academy.yandex.ru/events/frontend/shri_msk-2018-2) (осень 2018, Москва, Санкт-Петербург, Симферополь).

Для работы тестового приложения нужен Node.JS v9. В проекте используются [Yandex Maps API](https://tech.yandex.ru/maps/doc/jsapi/2.1/quick-start/index-docpage/) и [ChartJS](http://www.chartjs.org).

## Решение

1. [[baf7f70e](https://github.com/Astarta0/entrance-task-1-2/commit/baf7f70e4532759f1f1c03c27907c3e071477a0b)] После запуска приложения `npm start` видим в консоли предупреждение от вебпака при сборке -- не найден дефолтный
экспорт в `./map`
```
WARNING in ./src/index.js 4:2-9
"export 'default' (imported as 'initMap') was not found in './map'
 @ multi (webpack)-dev-server/client?http://localhost:9000 ./src/index.js
```
Исправить можно двумя способами: либо сделать экспорт дефолтным, либо изменить импорт в `index.js` на именованный. Я выбрала второй вариант.

2. [[cdb5434d](https://github.com/Astarta0/entrance-task-1-2/commit/cdb5434dc815f38d48d2dde22f256f74005c57c6)] При переходе видим пустую страницу. Смотрим код в `map.js` как инициируется карта. Идем в документацию к API яндекс карт, находим что в быстром старте написано про размер контейнера, что он должен быть не нулевым. Проверяем через devtools — карта действительно проинициализировалась (видим код внутри `#map`), но сам контейнер имеет нулевую высоту. Добавляем явное указание 100% высоты в css файл (можно были вместо процентов указать `100vh`).

3. [[204a4d61](https://github.com/Astarta0/entrance-task-1-2/commit/204a4d616bb7eab6934a4e2ea1b1a0fd98ac1886)] На карте отсутствуют метки. Внимательно смотрим на код отвечающий за создание объекта карты и размещения объектов на нем. Ищем в документации примеры, я заметила, что хоть объекты (в частности object manager) и создается, но он не размещается на карте, пропущен шаг с добавлением гео объекта.

4. [[bbf7d579](https://github.com/Astarta0/entrance-task-1-2/commit/bbf7d579c4db2def1191996097997ef4721ba6d9)] Метки на карте не появились, проверяем правильно ли они разместились на карте, возможно есть ошибка в координатах. В итоге я нашла ошибку в порядке следования координат в `mappers.js`, предварительно посмотрев в документации как размещаются точки и погуглив координаты Москвы :)

5. [[adb6e96f](https://github.com/Astarta0/entrance-task-1-2/commit/adb6e96f8c36cd39a804e7296a2416ee324429f7)] Проверяем показывается ли балун при клике на метку станции — при клике вываливается ошибка `TypeError: Cannot read property 'setData' of null`. По стектрейсу находим где возникла ошибка и понимаем что дело в балуне, в момент вызова `setData` свойство `balloon` равно `null`. Изучив пример из песочницы я поняла, что ошибка скорей всего в коде где он создается, скорей всего из-за переопределенных методов `build()` и `clear()`. В итоге ошибка в том, что использовались стрелочные функции (не имеют своего контекста), в данном случае это было критично, так как это переопределение методов.

6. [[69fea112](https://github.com/Astarta0/entrance-task-1-2/commit/69fea112a467bebc7c49bd11053646d15d91da0d)] График загруженности пустой и ось `y` имеет отрицательные значения. Убрала явно заданное значение `max: 0` для оси в `chart.js`, теперь она корректно масштабируется и график загруженности корректно отображается.

7. [[2308ba5d](https://github.com/Astarta0/entrance-task-1-2/commit/2308ba5d40807edd02c4efa4c469a172ff13895d)] При наведении на точку на графике тултип не полностью отображается, так как формат даты слишком длинный и на мой взгляд избыточный. Я поменяла формат даты, заменив вызов `.toString()` на `.toLocaleString()` в `getLabel()`.

8. [[08e73532](https://github.com/Astarta0/entrance-task-1-2/commit/08e735326763d22883a39f854ff38eeecf98b61d)] Теперь поправим определение цвета кластера, если в нем есть неисправные станции. Проблема была в том, что установка пресета перетирала настройки icon layout. Я удалила эту строку.

9. [[4af16b5c](https://github.com/Astarta0/entrance-task-1-2/commit/4af16b5c635c4146149de9e891079b253b397499)] Файл `popup.js` не используется в проекте поэтому удаляем его.

10. [[6ef54864](https://github.com/Astarta0/entrance-task-1-2/commit/6ef54864ceedd1c1ac760cc9dcba880300fd5af6)] Установим [prettier](https://prettier.io) для того, чтобы «причесать» кодстайл.

## Задание

Код содержит ошибки разной степени критичности. Некоторые из них — стилистические, а другие — даже не позволят вам запустить приложение. Вам нужно найти все ошибки и исправить их.

Пункты для самопроверки:

1. Приложение должно успешно запускаться.
1. По адресу http://localhost:9000 должна открываться карта с метками.
1. Должна правильно работать вся функциональность, перечисленная в условиях задания.
1. Не должно быть лишнего кода.
1. Все должно быть в едином codestyle.

## Запуск

```
npm i
npm start
```

При каждом запуске тестовые данные генерируются заново случайным образом.
